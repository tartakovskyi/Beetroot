"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _jquery=_interopRequireDefault(require("jquery")),_util=_interopRequireDefault(require("./util"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),o.forEach(function(e){_defineProperty(t,e,r[e])})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}var NAME="scrollspy",VERSION="4.2.1",DATA_KEY="bs.scrollspy",EVENT_KEY=".".concat(DATA_KEY),DATA_API_KEY=".data-api",JQUERY_NO_CONFLICT=_jquery.default.fn[NAME],Default={offset:10,method:"auto",target:""},DefaultType={offset:"number",method:"string",target:"(string|element)"},Event={ACTIVATE:"activate".concat(EVENT_KEY),SCROLL:"scroll".concat(EVENT_KEY),LOAD_DATA_API:"load".concat(EVENT_KEY).concat(DATA_API_KEY)},ClassName={DROPDOWN_ITEM:"dropdown-item",DROPDOWN_MENU:"dropdown-menu",ACTIVE:"active"},Selector={DATA_SPY:'[data-spy="scroll"]',ACTIVE:".active",NAV_LIST_GROUP:".nav, .list-group",NAV_LINKS:".nav-link",NAV_ITEMS:".nav-item",LIST_ITEMS:".list-group-item",DROPDOWN:".dropdown",DROPDOWN_ITEMS:".dropdown-item",DROPDOWN_TOGGLE:".dropdown-toggle"},OffsetMethod={OFFSET:"offset",POSITION:"position"},ScrollSpy=function(){function o(e,t){var r=this;_classCallCheck(this,o),this._element=e,this._scrollElement="BODY"===e.tagName?window:e,this._config=this._getConfig(t),this._selector="".concat(this._config.target," ").concat(Selector.NAV_LINKS,",")+"".concat(this._config.target," ").concat(Selector.LIST_ITEMS,",")+"".concat(this._config.target," ").concat(Selector.DROPDOWN_ITEMS),this._offsets=[],this._targets=[],this._activeTarget=null,(this._scrollHeight=0,_jquery.default)(this._scrollElement).on(Event.SCROLL,function(e){return r._process(e)}),this.refresh(),this._process()}return _createClass(o,[{key:"refresh",value:function(){var t=this,e=this._scrollElement===this._scrollElement.window?OffsetMethod.OFFSET:OffsetMethod.POSITION,l="auto"===this._config.method?e:this._config.method,n=l===OffsetMethod.POSITION?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),[].slice.call(document.querySelectorAll(this._selector)).map(function(e){var t,r=_util.default.getSelectorFromElement(e);if(r&&(t=document.querySelector(r)),t){var o=t.getBoundingClientRect();if(o.width||o.height)return[(0,_jquery.default)(t)[l]().top+n,r]}return null}).filter(function(e){return e}).sort(function(e,t){return e[0]-t[0]}).forEach(function(e){t._offsets.push(e[0]),t._targets.push(e[1])})}},{key:"dispose",value:function(){_jquery.default.removeData(this._element,DATA_KEY),(0,_jquery.default)(this._scrollElement).off(EVENT_KEY),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null}},{key:"_getConfig",value:function(e){if("string"!=typeof(e=_objectSpread({},Default,"object"===_typeof(e)&&e?e:{})).target){var t=(0,_jquery.default)(e.target).attr("id");t||(t=_util.default.getUID(NAME),(0,_jquery.default)(e.target).attr("id",t)),e.target="#".concat(t)}return _util.default.typeCheckConfig(NAME,e,DefaultType),e}},{key:"_getScrollTop",value:function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop}},{key:"_getScrollHeight",value:function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}},{key:"_getOffsetHeight",value:function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height}},{key:"_process",value:function(){var e=this._getScrollTop()+this._config.offset,t=this._getScrollHeight(),r=this._config.offset+t-this._getOffsetHeight();if(this._scrollHeight!==t&&this.refresh(),r<=e){var o=this._targets[this._targets.length-1];this._activeTarget!==o&&this._activate(o)}else{if(this._activeTarget&&e<this._offsets[0]&&0<this._offsets[0])return this._activeTarget=null,void this._clear();for(var l=this._offsets.length;l--;){this._activeTarget!==this._targets[l]&&e>=this._offsets[l]&&(void 0===this._offsets[l+1]||e<this._offsets[l+1])&&this._activate(this._targets[l])}}}},{key:"_activate",value:function(t){this._activeTarget=t,this._clear();var e=this._selector.split(",").map(function(e){return"".concat(e,'[data-target="').concat(t,'"],').concat(e,'[href="').concat(t,'"]')}),r=(0,_jquery.default)([].slice.call(document.querySelectorAll(e.join(","))));r.hasClass(ClassName.DROPDOWN_ITEM)?(r.closest(Selector.DROPDOWN).find(Selector.DROPDOWN_TOGGLE).addClass(ClassName.ACTIVE),r.addClass(ClassName.ACTIVE)):(r.addClass(ClassName.ACTIVE),r.parents(Selector.NAV_LIST_GROUP).prev("".concat(Selector.NAV_LINKS,", ").concat(Selector.LIST_ITEMS)).addClass(ClassName.ACTIVE),r.parents(Selector.NAV_LIST_GROUP).prev(Selector.NAV_ITEMS).children(Selector.NAV_LINKS).addClass(ClassName.ACTIVE)),(0,_jquery.default)(this._scrollElement).trigger(Event.ACTIVATE,{relatedTarget:t})}},{key:"_clear",value:function(){[].slice.call(document.querySelectorAll(this._selector)).filter(function(e){return e.classList.contains(ClassName.ACTIVE)}).forEach(function(e){return e.classList.remove(ClassName.ACTIVE)})}}],[{key:"_jQueryInterface",value:function(r){return this.each(function(){var e=(0,_jquery.default)(this).data(DATA_KEY),t="object"===_typeof(r)&&r;if(e||(e=new o(this,t),(0,_jquery.default)(this).data(DATA_KEY,e)),"string"==typeof r){if(void 0===e[r])throw new TypeError('No method named "'.concat(r,'"'));e[r]()}})}},{key:"VERSION",get:function(){return VERSION}},{key:"Default",get:function(){return Default}}]),o}();(0,_jquery.default)(window).on(Event.LOAD_DATA_API,function(){for(var e=[].slice.call(document.querySelectorAll(Selector.DATA_SPY)),t=e.length;t--;){var r=(0,_jquery.default)(e[t]);ScrollSpy._jQueryInterface.call(r,r.data())}}),_jquery.default.fn[NAME]=ScrollSpy._jQueryInterface,_jquery.default.fn[NAME].Constructor=ScrollSpy,_jquery.default.fn[NAME].noConflict=function(){return _jquery.default.fn[NAME]=JQUERY_NO_CONFLICT,ScrollSpy._jQueryInterface};var _default=ScrollSpy;exports.default=_default;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcm9sbHNweS5qcyJdLCJuYW1lcyI6WyJfanF1ZXJ5IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfdXRpbCIsIk5BTUUiLCJWRVJTSU9OIiwiREFUQV9LRVkiLCJFVkVOVF9LRVkiLCJjb25jYXQiLCJEQVRBX0FQSV9LRVkiLCJKUVVFUllfTk9fQ09ORkxJQ1QiLCIkIiwiZm4iLCJEZWZhdWx0Iiwib2Zmc2V0IiwibWV0aG9kIiwidGFyZ2V0IiwiRGVmYXVsdFR5cGUiLCJBQ1RJVkFURSIsIlNDUk9MTCIsIkxPQURfREFUQV9BUEkiLCJOQVZfTElTVF9HUk9VUCIsIk5BVl9MSU5LUyIsIkRST1BET1dOX0lURU0iLCJEUk9QRE9XTl9NRU5VIiwiQUNUSVZFIiwiRFJPUERPV05fSVRFTVMiLCJEUk9QRE9XTl9UT0dHTEUiLCJOQVZfSVRFTVMiLCJTY3JvbGxTcHkiLCJlbGVtZW50IiwiY29uZmlnIiwiX3RoaXMiLCJ0aGlzIiwiX2NsYXNzQ2FsbENoZWNrIiwiX2VsZW1lbnQiLCJfc2Nyb2xsRWxlbWVudCIsInRhZ05hbWUiLCJ3aW5kb3ciLCJfY29uZmlnIiwiX2dldENvbmZpZyIsIl9zZWxlY3RvciIsIlNlbGVjdG9yIiwiTElTVF9JVEVNUyIsIl90YXJnZXRzIiwiX2FjdGl2ZVRhcmdldCIsIl9zY3JvbGxIZWlnaHQiLCJkZWZhdWx0Iiwib24iLCJFdmVudCIsImV2ZW50IiwiX3Byb2Nlc3MiLCJyZWZyZXNoIiwiX3RoaXMyIiwiYXV0b01ldGhvZCIsIk9mZnNldE1ldGhvZCIsIk9GRlNFVCIsIlBPU0lUSU9OIiwib2Zmc2V0TWV0aG9kIiwib2Zmc2V0QmFzZSIsIl9vZmZzZXRzIiwiX2dldFNjcm9sbEhlaWdodCIsInNsaWNlIiwicXVlcnlTZWxlY3RvckFsbCIsIm1hcCIsInRhcmdldFNlbGVjdG9yIiwiVXRpbCIsImdldFNlbGVjdG9yRnJvbUVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJ0YXJnZXRCQ1IiLCJ3aWR0aCIsImhlaWdodCIsInRvcCIsImZpbHRlciIsImZvckVhY2giLCJpdGVtIiwic29ydCIsImEiLCJwdXNoIiwicmVtb3ZlRGF0YSIsIm9mZiIsIl90eXBlb2YiLCJpZCIsImdldFVJRCIsImF0dHIiLCJ0eXBlQ2hlY2tDb25maWciLCJwYWdlWU9mZnNldCIsInNjcm9sbFRvcCIsIk1hdGgiLCJib2R5Iiwic2Nyb2xsSGVpZ2h0IiwiZG9jdW1lbnRFbGVtZW50IiwiaW5uZXJIZWlnaHQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJtYXhTY3JvbGwiLCJfZ2V0T2Zmc2V0SGVpZ2h0IiwibGVuZ3RoIiwiX2FjdGl2YXRlIiwiX2NsZWFyIiwib2Zmc2V0TGVuZ3RoIiwiaSIsImlzQWN0aXZlVGFyZ2V0IiwicXVlcmllcyIsInNwbGl0Iiwic2VsZWN0b3IiLCIkbGluayIsImNhbGwiLCJoYXNDbGFzcyIsIkNsYXNzTmFtZSIsImNsb3Nlc3QiLCJmaW5kIiwiYWRkQ2xhc3MiLCJwYXJlbnRzIiwicHJldiIsImNoaWxkcmVuIiwidHJpZ2dlciIsInJlbGF0ZWRUYXJnZXQiLCJub2RlIiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJlYWNoIiwiZGF0YSIsIlR5cGVFcnJvciIsInNjcm9sbFNweXMiLCJEQVRBX1NQWSIsIiRzcHkiLCJfalF1ZXJ5SW50ZXJmYWNlIiwiQ29uc3RydWN0b3IiLCJub0NvbmZsaWN0Iiwic2Nyb2xsU3B5c0xlbmd0aCJdLCJtYXBwaW5ncyI6IjJGQU9BLElBQUFBLFFBQUFDLHVCQUFBQyxRQUFBLFdBQ0FDLE1BQUFGLHVCQUFBQyxRQUFBLDhxQ0FRQSxJQUFNRSxLQUFxQixZQUNyQkMsUUFBcUIsUUFDckJDLFNBQXFCLGVBQ3JCQyxVQUFTLElBQUFDLE9BQWdCRixVQUN6QkcsYUFBcUIsWUFDckJDLG1CQUFxQkMsUUFBQUEsUUFBRUMsR0FBR1IsTUFFMUJTLFFBQVUsQ0FDZEMsT0FBUyxHQWRYQyxPQUFBLE9BZ0JFQyxPQUFTLElBR0xDLFlBQWMsQ0FicEJILE9BQTJCLFNB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QUFDLEdBQUFSLE1BQUE2SCxXQUFFM0YsV0FFQSxPQURBM0IsUUFBQUEsUUFBQUMsR0FBTWdILE1BQUFBLG1CQUNBTSxVQUFBQSwrQkFHU3JHIiwiZmlsZSI6InNjcm9sbHNweS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIEJvb3RzdHJhcCAodjQuMi4xKTogc2Nyb2xsc3B5LmpzXG4gKiBMaWNlbnNlZCB1bmRlciBNSVQgKGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9ibG9iL21hc3Rlci9MSUNFTlNFKVxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqL1xuXG5pbXBvcnQgJCBmcm9tICdqcXVlcnknXG5pbXBvcnQgVXRpbCBmcm9tICcuL3V0aWwnXG5cbi8qKlxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBDb25zdGFudHNcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICovXG5cbmNvbnN0IE5BTUUgICAgICAgICAgICAgICA9ICdzY3JvbGxzcHknXG5jb25zdCBWRVJTSU9OICAgICAgICAgICAgPSAnNC4yLjEnXG5jb25zdCBEQVRBX0tFWSAgICAgICAgICAgPSAnYnMuc2Nyb2xsc3B5J1xuY29uc3QgRVZFTlRfS0VZICAgICAgICAgID0gYC4ke0RBVEFfS0VZfWBcbmNvbnN0IERBVEFfQVBJX0tFWSAgICAgICA9ICcuZGF0YS1hcGknXG5jb25zdCBKUVVFUllfTk9fQ09ORkxJQ1QgPSAkLmZuW05BTUVdXG5cbmNvbnN0IERlZmF1bHQgPSB7XG4gIG9mZnNldCA6IDEwLFxuICBtZXRob2QgOiAnYXV0bycsXG4gIHRhcmdldCA6ICcnXG59XG5cbmNvbnN0IERlZmF1bHRUeXBlID0ge1xuICBvZmZzZXQgOiAnbnVtYmVyJyxcbiAgbWV0aG9kIDogJ3N0cmluZycsXG4gIHRhcmdldCA6ICcoc3RyaW5nfGVsZW1lbnQpJ1xufVxuXG5jb25zdCBFdmVudCA9IHtcbiAgQUNUSVZBVEUgICAgICA6IGBhY3RpdmF0ZSR7RVZFTlRfS0VZfWAsXG4gIFNDUk9MTCAgICAgICAgOiBgc2Nyb2xsJHtFVkVOVF9LRVl9YCxcbiAgTE9BRF9EQVRBX0FQSSA6IGBsb2FkJHtFVkVOVF9LRVl9JHtEQVRBX0FQSV9LRVl9YFxufVxuXG5jb25zdCBDbGFzc05hbWUgPSB7XG4gIERST1BET1dOX0lURU0gOiAnZHJvcGRvd24taXRlbScsXG4gIERST1BET1dOX01FTlUgOiAnZHJvcGRvd24tbWVudScsXG4gIEFDVElWRSAgICAgICAgOiAnYWN0aXZlJ1xufVxuXG5jb25zdCBTZWxlY3RvciA9IHtcbiAgREFUQV9TUFkgICAgICAgIDogJ1tkYXRhLXNweT1cInNjcm9sbFwiXScsXG4gIEFDVElWRSAgICAgICAgICA6ICcuYWN0aXZlJyxcbiAgTkFWX0xJU1RfR1JPVVAgIDogJy5uYXYsIC5saXN0LWdyb3VwJyxcbiAgTkFWX0xJTktTICAgICAgIDogJy5uYXYtbGluaycsXG4gIE5BVl9JVEVNUyAgICAgICA6ICcubmF2LWl0ZW0nLFxuICBMSVNUX0lURU1TICAgICAgOiAnLmxpc3QtZ3JvdXAtaXRlbScsXG4gIERST1BET1dOICAgICAgICA6ICcuZHJvcGRvd24nLFxuICBEUk9QRE9XTl9JVEVNUyAgOiAnLmRyb3Bkb3duLWl0ZW0nLFxuICBEUk9QRE9XTl9UT0dHTEUgOiAnLmRyb3Bkb3duLXRvZ2dsZSdcbn1cblxuY29uc3QgT2Zmc2V0TWV0aG9kID0ge1xuICBPRkZTRVQgICA6ICdvZmZzZXQnLFxuICBQT1NJVElPTiA6ICdwb3NpdGlvbidcbn1cblxuLyoqXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIENsYXNzIERlZmluaXRpb25cbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICovXG5cbmNsYXNzIFNjcm9sbFNweSB7XG4gIGNvbnN0cnVjdG9yKGVsZW1lbnQsIGNvbmZpZykge1xuICAgIHRoaXMuX2VsZW1lbnQgICAgICAgPSBlbGVtZW50XG4gICAgdGhpcy5fc2Nyb2xsRWxlbWVudCA9IGVsZW1lbnQudGFnTmFtZSA9PT0gJ0JPRFknID8gd2luZG93IDogZWxlbWVudFxuICAgIHRoaXMuX2NvbmZpZyAgICAgICAgPSB0aGlzLl9nZXRDb25maWcoY29uZmlnKVxuICAgIHRoaXMuX3NlbGVjdG9yICAgICAgPSBgJHt0aGlzLl9jb25maWcudGFyZ2V0fSAke1NlbGVjdG9yLk5BVl9MSU5LU30sYCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGAke3RoaXMuX2NvbmZpZy50YXJnZXR9ICR7U2VsZWN0b3IuTElTVF9JVEVNU30sYCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGAke3RoaXMuX2NvbmZpZy50YXJnZXR9ICR7U2VsZWN0b3IuRFJPUERPV05fSVRFTVN9YFxuICAgIHRoaXMuX29mZnNldHMgICAgICAgPSBbXVxuICAgIHRoaXMuX3RhcmdldHMgICAgICAgPSBbXVxuICAgIHRoaXMuX2FjdGl2ZVRhcmdldCAgPSBudWxsXG4gICAgdGhpcy5fc2Nyb2xsSGVpZ2h0ICA9IDBcblxuICAgICQodGhpcy5fc2Nyb2xsRWxlbWVudCkub24oRXZlbnQuU0NST0xMLCAoZXZlbnQpID0+IHRoaXMuX3Byb2Nlc3MoZXZlbnQpKVxuXG4gICAgdGhpcy5yZWZyZXNoKClcbiAgICB0aGlzLl9wcm9jZXNzKClcbiAgfVxuXG4gIC8vIEdldHRlcnNcblxuICBzdGF0aWMgZ2V0IFZFUlNJT04oKSB7XG4gICAgcmV0dXJuIFZFUlNJT05cbiAgfVxuXG4gIHN0YXRpYyBnZXQgRGVmYXVsdCgpIHtcbiAgICByZXR1cm4gRGVmYXVsdFxuICB9XG5cbiAgLy8gUHVibGljXG5cbiAgcmVmcmVzaCgpIHtcbiAgICBjb25zdCBhdXRvTWV0aG9kID0gdGhpcy5fc2Nyb2xsRWxlbWVudCA9PT0gdGhpcy5fc2Nyb2xsRWxlbWVudC53aW5kb3dcbiAgICAgID8gT2Zmc2V0TWV0aG9kLk9GRlNFVCA6IE9mZnNldE1ldGhvZC5QT1NJVElPTlxuXG4gICAgY29uc3Qgb2Zmc2V0TWV0aG9kID0gdGhpcy5fY29uZmlnLm1ldGhvZCA9PT0gJ2F1dG8nXG4gICAgICA/IGF1dG9NZXRob2QgOiB0aGlzLl9jb25maWcubWV0aG9kXG5cbiAgICBjb25zdCBvZmZzZXRCYXNlID0gb2Zmc2V0TWV0aG9kID09PSBPZmZzZXRNZXRob2QuUE9TSVRJT05cbiAgICAgID8gdGhpcy5fZ2V0U2Nyb2xsVG9wKCkgOiAwXG5cbiAgICB0aGlzLl9vZmZzZXRzID0gW11cbiAgICB0aGlzLl90YXJnZXRzID0gW11cblxuICAgIHRoaXMuX3Njcm9sbEhlaWdodCA9IHRoaXMuX2dldFNjcm9sbEhlaWdodCgpXG5cbiAgICBjb25zdCB0YXJnZXRzID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NlbGVjdG9yKSlcblxuICAgIHRhcmdldHNcbiAgICAgIC5tYXAoKGVsZW1lbnQpID0+IHtcbiAgICAgICAgbGV0IHRhcmdldFxuICAgICAgICBjb25zdCB0YXJnZXRTZWxlY3RvciA9IFV0aWwuZ2V0U2VsZWN0b3JGcm9tRWxlbWVudChlbGVtZW50KVxuXG4gICAgICAgIGlmICh0YXJnZXRTZWxlY3Rvcikge1xuICAgICAgICAgIHRhcmdldCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGFyZ2V0U2VsZWN0b3IpXG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGFyZ2V0KSB7XG4gICAgICAgICAgY29uc3QgdGFyZ2V0QkNSID0gdGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gICAgICAgICAgaWYgKHRhcmdldEJDUi53aWR0aCB8fCB0YXJnZXRCQ1IuaGVpZ2h0KSB7XG4gICAgICAgICAgICAvLyBUT0RPIChmYXQpOiByZW1vdmUgc2tldGNoIHJlbGlhbmNlIG9uIGpRdWVyeSBwb3NpdGlvbi9vZmZzZXRcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICQodGFyZ2V0KVtvZmZzZXRNZXRob2RdKCkudG9wICsgb2Zmc2V0QmFzZSxcbiAgICAgICAgICAgICAgdGFyZ2V0U2VsZWN0b3JcbiAgICAgICAgICAgIF1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH0pXG4gICAgICAuZmlsdGVyKChpdGVtKSA9PiBpdGVtKVxuICAgICAgLnNvcnQoKGEsIGIpID0+IGFbMF0gLSBiWzBdKVxuICAgICAgLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgdGhpcy5fb2Zmc2V0cy5wdXNoKGl0ZW1bMF0pXG4gICAgICAgIHRoaXMuX3RhcmdldHMucHVzaChpdGVtWzFdKVxuICAgICAgfSlcbiAgfVxuXG4gIGRpc3Bvc2UoKSB7XG4gICAgJC5yZW1vdmVEYXRhKHRoaXMuX2VsZW1lbnQsIERBVEFfS0VZKVxuICAgICQodGhpcy5fc2Nyb2xsRWxlbWVudCkub2ZmKEVWRU5UX0tFWSlcblxuICAgIHRoaXMuX2VsZW1lbnQgICAgICAgPSBudWxsXG4gICAgdGhpcy5fc2Nyb2xsRWxlbWVudCA9IG51bGxcbiAgICB0aGlzLl9jb25maWcgICAgICAgID0gbnVsbFxuICAgIHRoaXMuX3NlbGVjdG9yICAgICAgPSBudWxsXG4gICAgdGhpcy5fb2Zmc2V0cyAgICAgICA9IG51bGxcbiAgICB0aGlzLl90YXJnZXRzICAgICAgID0gbnVsbFxuICAgIHRoaXMuX2FjdGl2ZVRhcmdldCAgPSBudWxsXG4gICAgdGhpcy5fc2Nyb2xsSGVpZ2h0ICA9IG51bGxcbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICBfZ2V0Q29uZmlnKGNvbmZpZykge1xuICAgIGNvbmZpZyA9IHtcbiAgICAgIC4uLkRlZmF1bHQsXG4gICAgICAuLi50eXBlb2YgY29uZmlnID09PSAnb2JqZWN0JyAmJiBjb25maWcgPyBjb25maWcgOiB7fVxuICAgIH1cblxuICAgIGlmICh0eXBlb2YgY29uZmlnLnRhcmdldCAhPT0gJ3N0cmluZycpIHtcbiAgICAgIGxldCBpZCA9ICQoY29uZmlnLnRhcmdldCkuYXR0cignaWQnKVxuICAgICAgaWYgKCFpZCkge1xuICAgICAgICBpZCA9IFV0aWwuZ2V0VUlEKE5BTUUpXG4gICAgICAgICQoY29uZmlnLnRhcmdldCkuYXR0cignaWQnLCBpZClcbiAgICAgIH1cbiAgICAgIGNvbmZpZy50YXJnZXQgPSBgIyR7aWR9YFxuICAgIH1cblxuICAgIFV0aWwudHlwZUNoZWNrQ29uZmlnKE5BTUUsIGNvbmZpZywgRGVmYXVsdFR5cGUpXG5cbiAgICByZXR1cm4gY29uZmlnXG4gIH1cblxuICBfZ2V0U2Nyb2xsVG9wKCkge1xuICAgIHJldHVybiB0aGlzLl9zY3JvbGxFbGVtZW50ID09PSB3aW5kb3dcbiAgICAgID8gdGhpcy5fc2Nyb2xsRWxlbWVudC5wYWdlWU9mZnNldCA6IHRoaXMuX3Njcm9sbEVsZW1lbnQuc2Nyb2xsVG9wXG4gIH1cblxuICBfZ2V0U2Nyb2xsSGVpZ2h0KCkge1xuICAgIHJldHVybiB0aGlzLl9zY3JvbGxFbGVtZW50LnNjcm9sbEhlaWdodCB8fCBNYXRoLm1heChcbiAgICAgIGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0LFxuICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbEhlaWdodFxuICAgIClcbiAgfVxuXG4gIF9nZXRPZmZzZXRIZWlnaHQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Njcm9sbEVsZW1lbnQgPT09IHdpbmRvd1xuICAgICAgPyB3aW5kb3cuaW5uZXJIZWlnaHQgOiB0aGlzLl9zY3JvbGxFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodFxuICB9XG5cbiAgX3Byb2Nlc3MoKSB7XG4gICAgY29uc3Qgc2Nyb2xsVG9wICAgID0gdGhpcy5fZ2V0U2Nyb2xsVG9wKCkgKyB0aGlzLl9jb25maWcub2Zmc2V0XG4gICAgY29uc3Qgc2Nyb2xsSGVpZ2h0ID0gdGhpcy5fZ2V0U2Nyb2xsSGVpZ2h0KClcbiAgICBjb25zdCBtYXhTY3JvbGwgICAgPSB0aGlzLl9jb25maWcub2Zmc2V0ICtcbiAgICAgIHNjcm9sbEhlaWdodCAtXG4gICAgICB0aGlzLl9nZXRPZmZzZXRIZWlnaHQoKVxuXG4gICAgaWYgKHRoaXMuX3Njcm9sbEhlaWdodCAhPT0gc2Nyb2xsSGVpZ2h0KSB7XG4gICAgICB0aGlzLnJlZnJlc2goKVxuICAgIH1cblxuICAgIGlmIChzY3JvbGxUb3AgPj0gbWF4U2Nyb2xsKSB7XG4gICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLl90YXJnZXRzW3RoaXMuX3RhcmdldHMubGVuZ3RoIC0gMV1cblxuICAgICAgaWYgKHRoaXMuX2FjdGl2ZVRhcmdldCAhPT0gdGFyZ2V0KSB7XG4gICAgICAgIHRoaXMuX2FjdGl2YXRlKHRhcmdldClcbiAgICAgIH1cbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGlmICh0aGlzLl9hY3RpdmVUYXJnZXQgJiYgc2Nyb2xsVG9wIDwgdGhpcy5fb2Zmc2V0c1swXSAmJiB0aGlzLl9vZmZzZXRzWzBdID4gMCkge1xuICAgICAgdGhpcy5fYWN0aXZlVGFyZ2V0ID0gbnVsbFxuICAgICAgdGhpcy5fY2xlYXIoKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgY29uc3Qgb2Zmc2V0TGVuZ3RoID0gdGhpcy5fb2Zmc2V0cy5sZW5ndGhcbiAgICBmb3IgKGxldCBpID0gb2Zmc2V0TGVuZ3RoOyBpLS07KSB7XG4gICAgICBjb25zdCBpc0FjdGl2ZVRhcmdldCA9IHRoaXMuX2FjdGl2ZVRhcmdldCAhPT0gdGhpcy5fdGFyZ2V0c1tpXSAmJlxuICAgICAgICAgIHNjcm9sbFRvcCA+PSB0aGlzLl9vZmZzZXRzW2ldICYmXG4gICAgICAgICAgKHR5cGVvZiB0aGlzLl9vZmZzZXRzW2kgKyAxXSA9PT0gJ3VuZGVmaW5lZCcgfHxcbiAgICAgICAgICAgICAgc2Nyb2xsVG9wIDwgdGhpcy5fb2Zmc2V0c1tpICsgMV0pXG5cbiAgICAgIGlmIChpc0FjdGl2ZVRhcmdldCkge1xuICAgICAgICB0aGlzLl9hY3RpdmF0ZSh0aGlzLl90YXJnZXRzW2ldKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIF9hY3RpdmF0ZSh0YXJnZXQpIHtcbiAgICB0aGlzLl9hY3RpdmVUYXJnZXQgPSB0YXJnZXRcblxuICAgIHRoaXMuX2NsZWFyKClcblxuICAgIGNvbnN0IHF1ZXJpZXMgPSB0aGlzLl9zZWxlY3RvclxuICAgICAgLnNwbGl0KCcsJylcbiAgICAgIC5tYXAoKHNlbGVjdG9yKSA9PiBgJHtzZWxlY3Rvcn1bZGF0YS10YXJnZXQ9XCIke3RhcmdldH1cIl0sJHtzZWxlY3Rvcn1baHJlZj1cIiR7dGFyZ2V0fVwiXWApXG5cbiAgICBjb25zdCAkbGluayA9ICQoW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHF1ZXJpZXMuam9pbignLCcpKSkpXG5cbiAgICBpZiAoJGxpbmsuaGFzQ2xhc3MoQ2xhc3NOYW1lLkRST1BET1dOX0lURU0pKSB7XG4gICAgICAkbGluay5jbG9zZXN0KFNlbGVjdG9yLkRST1BET1dOKS5maW5kKFNlbGVjdG9yLkRST1BET1dOX1RPR0dMRSkuYWRkQ2xhc3MoQ2xhc3NOYW1lLkFDVElWRSlcbiAgICAgICRsaW5rLmFkZENsYXNzKENsYXNzTmFtZS5BQ1RJVkUpXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFNldCB0cmlnZ2VyZWQgbGluayBhcyBhY3RpdmVcbiAgICAgICRsaW5rLmFkZENsYXNzKENsYXNzTmFtZS5BQ1RJVkUpXG4gICAgICAvLyBTZXQgdHJpZ2dlcmVkIGxpbmtzIHBhcmVudHMgYXMgYWN0aXZlXG4gICAgICAvLyBXaXRoIGJvdGggPHVsPiBhbmQgPG5hdj4gbWFya3VwIGEgcGFyZW50IGlzIHRoZSBwcmV2aW91cyBzaWJsaW5nIG9mIGFueSBuYXYgYW5jZXN0b3JcbiAgICAgICRsaW5rLnBhcmVudHMoU2VsZWN0b3IuTkFWX0xJU1RfR1JPVVApLnByZXYoYCR7U2VsZWN0b3IuTkFWX0xJTktTfSwgJHtTZWxlY3Rvci5MSVNUX0lURU1TfWApLmFkZENsYXNzKENsYXNzTmFtZS5BQ1RJVkUpXG4gICAgICAvLyBIYW5kbGUgc3BlY2lhbCBjYXNlIHdoZW4gLm5hdi1saW5rIGlzIGluc2lkZSAubmF2LWl0ZW1cbiAgICAgICRsaW5rLnBhcmVudHMoU2VsZWN0b3IuTkFWX0xJU1RfR1JPVVApLnByZXYoU2VsZWN0b3IuTkFWX0lURU1TKS5jaGlsZHJlbihTZWxlY3Rvci5OQVZfTElOS1MpLmFkZENsYXNzKENsYXNzTmFtZS5BQ1RJVkUpXG4gICAgfVxuXG4gICAgJCh0aGlzLl9zY3JvbGxFbGVtZW50KS50cmlnZ2VyKEV2ZW50LkFDVElWQVRFLCB7XG4gICAgICByZWxhdGVkVGFyZ2V0OiB0YXJnZXRcbiAgICB9KVxuICB9XG5cbiAgX2NsZWFyKCkge1xuICAgIFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9zZWxlY3RvcikpXG4gICAgICAuZmlsdGVyKChub2RlKSA9PiBub2RlLmNsYXNzTGlzdC5jb250YWlucyhDbGFzc05hbWUuQUNUSVZFKSlcbiAgICAgIC5mb3JFYWNoKChub2RlKSA9PiBub2RlLmNsYXNzTGlzdC5yZW1vdmUoQ2xhc3NOYW1lLkFDVElWRSkpXG4gIH1cblxuICAvLyBTdGF0aWNcblxuICBzdGF0aWMgX2pRdWVyeUludGVyZmFjZShjb25maWcpIHtcbiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBkYXRhID0gJCh0aGlzKS5kYXRhKERBVEFfS0VZKVxuICAgICAgY29uc3QgX2NvbmZpZyA9IHR5cGVvZiBjb25maWcgPT09ICdvYmplY3QnICYmIGNvbmZpZ1xuXG4gICAgICBpZiAoIWRhdGEpIHtcbiAgICAgICAgZGF0YSA9IG5ldyBTY3JvbGxTcHkodGhpcywgX2NvbmZpZylcbiAgICAgICAgJCh0aGlzKS5kYXRhKERBVEFfS0VZLCBkYXRhKVxuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIGNvbmZpZyA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBkYXRhW2NvbmZpZ10gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgTm8gbWV0aG9kIG5hbWVkIFwiJHtjb25maWd9XCJgKVxuICAgICAgICB9XG4gICAgICAgIGRhdGFbY29uZmlnXSgpXG4gICAgICB9XG4gICAgfSlcbiAgfVxufVxuXG4vKipcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogRGF0YSBBcGkgaW1wbGVtZW50YXRpb25cbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICovXG5cbiQod2luZG93KS5vbihFdmVudC5MT0FEX0RBVEFfQVBJLCAoKSA9PiB7XG4gIGNvbnN0IHNjcm9sbFNweXMgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoU2VsZWN0b3IuREFUQV9TUFkpKVxuICBjb25zdCBzY3JvbGxTcHlzTGVuZ3RoID0gc2Nyb2xsU3B5cy5sZW5ndGhcblxuICBmb3IgKGxldCBpID0gc2Nyb2xsU3B5c0xlbmd0aDsgaS0tOykge1xuICAgIGNvbnN0ICRzcHkgPSAkKHNjcm9sbFNweXNbaV0pXG4gICAgU2Nyb2xsU3B5Ll9qUXVlcnlJbnRlcmZhY2UuY2FsbCgkc3B5LCAkc3B5LmRhdGEoKSlcbiAgfVxufSlcblxuLyoqXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIGpRdWVyeVxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKi9cblxuJC5mbltOQU1FXSA9IFNjcm9sbFNweS5falF1ZXJ5SW50ZXJmYWNlXG4kLmZuW05BTUVdLkNvbnN0cnVjdG9yID0gU2Nyb2xsU3B5XG4kLmZuW05BTUVdLm5vQ29uZmxpY3QgPSAoKSA9PiB7XG4gICQuZm5bTkFNRV0gPSBKUVVFUllfTk9fQ09ORkxJQ1RcbiAgcmV0dXJuIFNjcm9sbFNweS5falF1ZXJ5SW50ZXJmYWNlXG59XG5cbmV4cG9ydCBkZWZhdWx0IFNjcm9sbFNweVxuIl19
